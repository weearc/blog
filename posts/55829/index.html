<!DOCTYPE html>
<html lang="zh" dir="ltr">
<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Firefox每夜构建食用指南 | weearc 的个人博客</title>


<script src="https://blog.weearc.top/js/lib/jquery-3.7.1.min.js"></script>


<script src="https://blog.weearc.top/js/lib/fuse.js"></script>


<link href="https://blog.weearc.top/css/lib/pure-min.css" rel="stylesheet">


    <link href="https://blog.weearc.top/css/lib/grids-responsive-min.css" rel="stylesheet">


<link href="https://blog.weearc.top/css/lib/font-awesome.min.css" rel="stylesheet">



  <link rel="stylesheet" href="https://blog.weearc.top/css/main.e14d6e97a633ae72a7963b2b2e87f950d1f54e0d084abbc09bed682f9d98142f.css" integrity="sha256-4U1ul6YzrnKnljsrLof5UNH1Tg0ISrvAm&#43;1oL52YFC8=" crossorigin="anonymous">




      <script src="/js/main.1de2e63b2f316e087a071ebe652e354054e2d100b986d2002f27cccfd8a24ff0.js" integrity="sha256-HeLmOy8xbgh6Bx6&#43;ZS41QFTi0QC5htIALyfMz9iiT/A=" crossorigin="anonymous"></script>




</head>
<body>
  <div class="body__container">
    <div id="header">
      <div class="site__name" >
    <a id="logo" href="/.">weearc 的个人博客</a>
    <p class="description">想离相惜莫相忘，且行且歌且珍惜</p>
</div>
<div id="nav-menu">
    
    
    
        <a href="https://blog.weearc.top/" title="首页">
           <i class="fa fa-home">首页</i>
        </a>
        <a href="https://blog.weearc.top/archives/" title="归档">
           <i class="fa fa-archive">归档</i>
        </a>
        <a href="https://blog.weearc.top/frlink/" title="友链">
           <i class="fa fa-link">友链</i>
        </a>
        <a href="https://blog.weearc.top/about/" title="关于">
           <i class="fa fa-user">关于</i>
        </a>
        <a href="https://blog.weearc.top/index.xml" title="订阅">
           <i class="fa fa-rss">订阅</i>
        </a>
</div>


    </div>
    <div class="pure-g" id="layout">
      <div class="pure-u-1  pure-u-md-3-4 ">
        <div class="content__container">
          
  <div class="post">
    <h1 class="post-title">Firefox每夜构建食用指南</h1>
    
    <div class="post-meta">
      
      
      
      <span datetime="2018-08-25T16:04:16&#43;00:00">Aug. 25, 2018</span>
      <span class="post-time">
        <span class="post-meta-item-text"> | </span>
        <span class="post-meta-item-icon">
          <i class="fa fa-keyboard-o"></i>
          <span class="post-count">2174</span>
          <span class="post-meta-item-text"> 字</span>
        </span>
      </span>
    </div>
    
    
    <a class="disqus-comment-count" href="./#vcomments">
      <span class="valine-comment-count" data-xid="/posts/55829/"></span>
      <span> 条评论</span>
    </a>
    
    
    <div class="clear">
      
        <div class="toc-article" id="toc">
          <div class="toc-title">文章目录</div>
          <nav id="TableOfContents">
  <ul>
    <li><a href="#升级模块">升级模块</a>
      <ul>
        <li><a href="#下载模块">下载模块</a></li>
        <li><a href="#权限判断模块">权限判断模块</a></li>
      </ul>
    </li>
    <li><a href="#版本号模块">版本号模块</a></li>
    <li><a href="#夜间定时检测任务添加">夜间定时检测任务添加</a></li>
  </ul>
</nav>
        </div>
      
    </div>
    
    <div class="post-content">
      <p>可能和你想的不大一样，这是个不算完善的方法，但保证好用。</p>
<h1 id="firefox下载及安装">Firefox下载及”安装“</h1>
<p>首先说明一下，<a href="https://github.com/archlinuxcn/repo">archlinuxCN repo</a>里面有每夜构建版本的Firefox，而且是四种语言版本:简体中文，正體中文，日本語，English(US)。但是这是我事后才知道的。话说回来，就算是使用了Mozilla官方的版本其实还是一个不错的选择。毕竟是预编译可执行文件，位置随意放置，比如我就放到了 <strong>opt</strong>下面。如果熟悉.desktop文件编写的话只要自己写个启动器就好，简单明了。这点还是要感谢一下Mozilla的打包方式，解压后的文件名统一就是Firefox。因此也可以做到多个Firefox版本共存。
由于一些不可见光的原因，国内用户在百度搜索Firefox浏览器的时候会被redirect到火狐浏览器那里</br></p>
<blockquote>
<p>好了你看到了，我把Firefox与火狐作了区分</p>
</blockquote>
<p>为什么？因为你要是仔细观察就会发现不光是安装程序和协议，就连官网本身都并不相同（不只是语言），国内官网是被阉割过的。因此想要下载Mozilla软件请一定要认准Mozilla的官方地址，根据其性质是以org域名。<a href="https://www.mozilla.org/zh-CN/firefox/">传送门</a>。Mozilla有CDN加持，国内访问速度尚可。
接下来就是直接将页面拖到最低端，选择 <a href="https://www.mozilla.org/zh-CN/firefox/channel/desktop/"><strong>Beta、Nightly、Developer Edition</strong></a>然后找到那个非常酷炫的nightly图标，点进去进行下载。
Mozilla会在你进行下载的时候对系统进行判断，Linux下载后会得到一个以tar.bz2作为扩展名的归档文件。直接移动到/opt目录下面，获取root权限并解压：</p>
<div class="highlight"><div style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>tar -xvf firefox-nightly-版本号.0a1.tar.bz2
</span></span></code></pre></td></tr></table>
</div>
</div><p>我这里写版本号诸君都能看懂吧，不要傻乎乎地复制粘贴。解压后会自动生成目录Firefox，此时在家目录下建立Firefox-nightly.desktop文件并填入以下内容（遵循X11标准，部分是KDE标准，DBUS部分可以不用理会）</p>
<div class="highlight"><div style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#666">[</span>Desktop Entry<span style="color:#666">]</span>
</span></span><span style="display:flex;"><span>Comment<span style="color:#666">[</span>zh_CN<span style="color:#666">]=</span>
</span></span><span style="display:flex;"><span><span style="color:#b8860b">Comment</span><span style="color:#666">=</span>
</span></span><span style="display:flex;"><span><span style="color:#b8860b">Exec</span><span style="color:#666">=</span>/opt/firefox/firefox
</span></span><span style="display:flex;"><span>GenericName<span style="color:#666">[</span>zh_CN<span style="color:#666">]=</span>
</span></span><span style="display:flex;"><span><span style="color:#b8860b">GenericName</span><span style="color:#666">=</span>
</span></span><span style="display:flex;"><span><span style="color:#b8860b">Icon</span><span style="color:#666">=</span>/opt/firefox/browser/chrome/icons/default/default128.png
</span></span><span style="display:flex;"><span><span style="color:#b8860b">MimeType</span><span style="color:#666">=</span>
</span></span><span style="display:flex;"><span>Name<span style="color:#666">[</span>zh_CN<span style="color:#666">]=</span>firefox nightly
</span></span><span style="display:flex;"><span><span style="color:#b8860b">Name</span><span style="color:#666">=</span>firefox nightly
</span></span><span style="display:flex;"><span><span style="color:#b8860b">Path</span><span style="color:#666">=</span>
</span></span><span style="display:flex;"><span><span style="color:#b8860b">StartupNotify</span><span style="color:#666">=</span><span style="color:#a2f">true</span>
</span></span><span style="display:flex;"><span><span style="color:#b8860b">Terminal</span><span style="color:#666">=</span><span style="color:#a2f">false</span>
</span></span><span style="display:flex;"><span><span style="color:#b8860b">TerminalOptions</span><span style="color:#666">=</span>
</span></span><span style="display:flex;"><span><span style="color:#b8860b">Type</span><span style="color:#666">=</span>Application
</span></span><span style="display:flex;"><span>X-DBUS-ServiceName<span style="color:#666">=</span>
</span></span><span style="display:flex;"><span>X-DBUS-StartupType<span style="color:#666">=</span>
</span></span><span style="display:flex;"><span>X-KDE-RunOnDiscreteGpu<span style="color:#666">=</span><span style="color:#a2f">false</span>
</span></span><span style="display:flex;"><span>X-KDE-SubstituteUID<span style="color:#666">=</span><span style="color:#a2f">false</span>
</span></span><span style="display:flex;"><span>X-KDE-Username<span style="color:#666">=</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>这里需要注意一点就是我偷懒了，实际上的写法应该参考archlinuxCN的Firefox-nightly.desktop：</p>
<div class="highlight"><div style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#666">[</span>Desktop Entry<span style="color:#666">]</span>
</span></span><span style="display:flex;"><span><span style="color:#b8860b">Name</span><span style="color:#666">=</span>Firefox Nightly
</span></span><span style="display:flex;"><span><span style="color:#b8860b">GenericName</span><span style="color:#666">=</span>Web Browser
</span></span><span style="display:flex;"><span>Comment<span style="color:#666">[</span>zh_CN<span style="color:#666">]=</span>浏览互联网
</span></span><span style="display:flex;"><span><span style="color:#b8860b">Exec</span><span style="color:#666">=</span>firefox-nightly --class<span style="color:#666">=</span>FirefoxNightly %u
</span></span><span style="display:flex;"><span><span style="color:#b8860b">Icon</span><span style="color:#666">=</span>firefox-nightly
</span></span><span style="display:flex;"><span><span style="color:#b8860b">Terminal</span><span style="color:#666">=</span><span style="color:#a2f">false</span>
</span></span><span style="display:flex;"><span><span style="color:#b8860b">Type</span><span style="color:#666">=</span>Application
</span></span><span style="display:flex;"><span><span style="color:#b8860b">MimeType</span><span style="color:#666">=</span>text/html;text/xml;application/xhtml+xml;application/vnd.mozilla.xul+xml;text/mml;x-scheme-handler/http;x-scheme-handler/https;
</span></span><span style="display:flex;"><span><span style="color:#b8860b">StartupNotify</span><span style="color:#666">=</span><span style="color:#a2f">true</span>
</span></span><span style="display:flex;"><span><span style="color:#b8860b">StartupWMClass</span><span style="color:#666">=</span>FirefoxNightly
</span></span><span style="display:flex;"><span><span style="color:#b8860b">Categories</span><span style="color:#666">=</span>Network;WebBrowser;
</span></span><span style="display:flex;"><span><span style="color:#b8860b">Keywords</span><span style="color:#666">=</span>web;browser;internet;
</span></span><span style="display:flex;"><span><span style="color:#b8860b">Actions</span><span style="color:#666">=</span>new-window;new-private-window;
</span></span><span style="display:flex;"><span><span style="color:#666">[</span>Desktop Action new-window<span style="color:#666">]</span>
</span></span><span style="display:flex;"><span><span style="color:#b8860b">Name</span><span style="color:#666">=</span>New Window
</span></span><span style="display:flex;"><span>Name<span style="color:#666">[</span>zh_CN<span style="color:#666">]=</span>新建窗口
</span></span><span style="display:flex;"><span><span style="color:#b8860b">Exec</span><span style="color:#666">=</span>firefox-nightly --class<span style="color:#666">=</span>FirefoxNightly --new-window %u
</span></span><span style="display:flex;"><span><span style="color:#666">[</span>Desktop Action new-private-window<span style="color:#666">]</span>
</span></span><span style="display:flex;"><span><span style="color:#b8860b">Name</span><span style="color:#666">=</span>New Private Window
</span></span><span style="display:flex;"><span>Name<span style="color:#666">[</span>en_US<span style="color:#666">]=</span>New Private Window
</span></span><span style="display:flex;"><span>Name<span style="color:#666">[</span>zh_CN<span style="color:#666">]=</span>新建隐私浏览窗口
</span></span><span style="display:flex;"><span><span style="color:#b8860b">Exec</span><span style="color:#666">=</span>firefox-nightly --class<span style="color:#666">=</span>FirefoxNightly --private-window %u
</span></span></code></pre></td></tr></table>
</div>
</div><p>在这个写法中能够实现隐私窗口的调用，使得功能上更加完善。
至此Firefox-nightly安装完毕。你以为这就可以满足我了吗？才怪。</p>
<h1 id="自升级脚本编写">自升级脚本编写</h1>
<h2 id="升级模块">升级模块</h2>
<h3 id="下载模块">下载模块</h3>
<p>很简单，如果通过Firefox下载浏览器新版本的话能够直接看到下载的链接，形如：https://download-installer.cdn.mozilla.net/pub/firefox/nightly/latest-mozilla-central-l10n/firefox-59.0a1.zh-CN.linux-x86_64.tar.bz2 。 那么之后就只需要替换版本号就可以了。但是也存在一个问题，就是如果版本号写死了，那么之后的升级操作通过执行脚本就显得很困难，而且最多只能保持在某一版本号这短暂的生命周期内。因此结合以前学习archlinux的PKGBUILD编写时某贴吧大佬的提示，将版本号全部使用 <strong>$pkgver</strong> 代替。根据bash的语法。此变量的声明应该在头部进行而且使用$声明的变量应该是有前部程序输出的。但是毕竟本人能力有限还不能够写出能直接被识别的变量名称（毕竟web地址特殊字符不少）。</br>
因此，思路是首先编写版本号文件pkgver.txt，在这个文件中输入版本号，借由cat命令执行输出并对之后变量的引用进行输入。
因此,整个过程简化为：</p>
<div class="highlight"><div style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript3" data-lang="gdscript3"><span style="display:flex;"><span>cd <span style="color:#666">/</span>opt
</span></span><span style="display:flex;"><span>_pkgver<span style="color:#666">=$</span>(cat pkgver<span style="color:#666">.</span>txt)
</span></span><span style="display:flex;"><span>wget https:<span style="color:#666">//</span>download<span style="color:#666">-</span>installer<span style="color:#666">.</span>cdn<span style="color:#666">.</span>mozilla<span style="color:#666">.</span>net<span style="color:#666">/</span>pub<span style="color:#666">/</span>firefox<span style="color:#666">/</span>nightly<span style="color:#666">/</span>latest<span style="color:#666">-</span>mozilla<span style="color:#666">-</span>central<span style="color:#666">-</span>l10n<span style="color:#666">/</span>firefox<span style="color:#666">-$</span>_pkgver<span style="color:#666">.</span><span style="color:#666">0</span>a1<span style="color:#666">.</span>zh<span style="color:#666">-</span>CN<span style="color:#666">.</span>linux<span style="color:#666">-</span>x86_64<span style="color:#666">.</span>tar<span style="color:#666">.</span>bz2
</span></span><span style="display:flex;"><span>tar <span style="color:#666">-</span>xvf firefox<span style="color:#666">-$</span>_pkgver<span style="color:#666">.</span><span style="color:#666">0</span>a1<span style="color:#666">.</span>zh<span style="color:#666">-</span>CN<span style="color:#666">.</span>linux<span style="color:#666">-</span>x86_64<span style="color:#666">.</span>tar<span style="color:#666">.</span>bz2 <span style="color:#080;font-style:italic">#解压时会自动覆盖</span>
</span></span><span style="display:flex;"><span>rm <span style="color:#666">-</span>xvf firefox<span style="color:#666">-$</span>_pkgver<span style="color:#666">.</span><span style="color:#666">0</span>a1<span style="color:#666">.</span>zh<span style="color:#666">-</span>CN<span style="color:#666">.</span>linux<span style="color:#666">-</span>x86_64<span style="color:#666">.</span>tar<span style="color:#666">.</span>bz
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="权限判断模块">权限判断模块</h3>
<p>上面我们讲了升级的基本操作：下载包，解压，删除。但是我们需要注意一点，我们在执行脚本时身份不是root，这样会容易造成麻烦。因此需要添加一个简单的身份验证模块,整个过程借由if语句:</p>
<div class="highlight"><div style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript3" data-lang="gdscript3"><span style="display:flex;"><span><span style="color:#a2f;font-weight:bold">if</span> [[ <span style="color:#666">$</span>EUID <span style="color:#666">-</span>eq <span style="color:#666">0</span> ]]
</span></span><span style="display:flex;"><span>then    cd <span style="color:#666">/</span>opt
</span></span><span style="display:flex;"><span>    _pkgver<span style="color:#666">=$</span>(cat pkgver<span style="color:#666">.</span>txt)
</span></span><span style="display:flex;"><span>    wget https:<span style="color:#666">//</span>download<span style="color:#666">-</span>installer<span style="color:#666">.</span>cdn<span style="color:#666">.</span>mozilla<span style="color:#666">.</span>net<span style="color:#666">/</span>pub<span style="color:#666">/</span>firefox<span style="color:#666">/</span>nightly<span style="color:#666">/</span>latest<span style="color:#666">-</span>mozilla<span style="color:#666">-</span>central<span style="color:#666">-</span>l10n<span style="color:#666">/</span>firefox<span style="color:#666">-$</span>_pkgver<span style="color:#666">.</span><span style="color:#666">0</span>a1<span style="color:#666">.</span>zh<span style="color:#666">-</span>CN<span style="color:#666">.</span>linux<span style="color:#666">-</span>x86_64<span style="color:#666">.</span>tar<span style="color:#666">.</span>bz2
</span></span><span style="display:flex;"><span>    tar <span style="color:#666">-</span>xvf firefox<span style="color:#666">-$</span>_pkgver<span style="color:#666">.</span><span style="color:#666">0</span>a1<span style="color:#666">.</span>zh<span style="color:#666">-</span>CN<span style="color:#666">.</span>linux<span style="color:#666">-</span>x86_64<span style="color:#666">.</span>tar<span style="color:#666">.</span>bz2 <span style="color:#080;font-style:italic">#解压时会自动覆盖</span>
</span></span><span style="display:flex;"><span>    rm <span style="color:#666">-</span>xvf firefox<span style="color:#666">-$</span>_pkgver<span style="color:#666">.</span><span style="color:#666">0</span>a1<span style="color:#666">.</span>zh<span style="color:#666">-</span>CN<span style="color:#666">.</span>linux<span style="color:#666">-</span>x86_64<span style="color:#666">.</span>tar<span style="color:#666">.</span>bz;<span style="color:#a2f;font-weight:bold">else</span>
</span></span><span style="display:flex;"><span>    echo <span style="color:#b44">&#34;Please run it use sudo or as root user!&#34;</span>;
</span></span><span style="display:flex;"><span>fi
</span></span></code></pre></td></tr></table>
</div>
</div><p>提示一点，千万不要忘记bash中if对空格敏感&hellip;还有就是分号不要忘记。</p>
<h2 id="版本号模块">版本号模块</h2>
<p>正常来说的话，我们手动下载新构建的nightly时，Firefox会自动调用函数向上游发出请求来判断是否需要更新，但是我们自己的话就没有办法是用这个。因此我们需要手动构建一个。
上面已经可以知道我们有一个名为 <strong>pkgver.txt</strong> 的额外的文件用来检测版本号。然后我们也很容易发现如果尝试下载旧版本的包时候会返回404。那么，这样思路就很明确了：</p>
<ul>
<li>使用curl来获取http_code</li>
<li>使用tail，利用管道获取上面的返回值并剪切</li>
<li>使用一个循环来不断调用版本号的函数</li>
</ul>
<p>那么可以利用以下代码：
首先定义一个_link来存放链接</p>
<div class="highlight"><div style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript3" data-lang="gdscript3"><span style="display:flex;"><span>_link<span style="color:#666">=</span>https:<span style="color:#666">//</span>download<span style="color:#666">-</span>installer<span style="color:#666">.</span>cdn<span style="color:#666">.</span>mozilla<span style="color:#666">.</span>net<span style="color:#666">/</span>pub<span style="color:#666">/</span>firefox<span style="color:#666">/</span>nightly<span style="color:#666">/</span>latest<span style="color:#666">-</span>mozilla<span style="color:#666">-</span>central<span style="color:#666">-</span>l10n<span style="color:#666">/</span>firefox<span style="color:#666">-$</span>_pkgver<span style="color:#666">.</span><span style="color:#666">0</span>a1<span style="color:#666">.</span>zh<span style="color:#666">-</span>CN<span style="color:#666">.</span>linux<span style="color:#666">-</span>x86_64<span style="color:#666">.</span>tar<span style="color:#666">.</span>bz2
</span></span></code></pre></td></tr></table>
</div>
</div><p>然后使用curl来获取http_code</p>
<div class="highlight"><div style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>curl -I -s --connect-timeout 5 $_link -w %{http_code}
</span></span></code></pre></td></tr></table>
</div>
</div><p>此时应该可以正常获取到网页或者该文件信息了。
使用管道：</p>
<div class="highlight"><div style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>curl -I -s --connect-timeout 5 $_link -w %{http_code}
</span></span></code></pre></td></tr></table>
</div>
</div><p>定义到新的变量：</p>
<div class="highlight"><div style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$_httpcode=(curl -I -s --connect-timeout 5 $_link -w %{http_code})
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="夜间定时检测任务添加">夜间定时检测任务添加</h2>
<p>TODO：</br></p>
<ul>
<li><input checked="" disabled="" type="checkbox"> 基础模块编写</li>
<li><input checked="" disabled="" type="checkbox"> 发行版判断并可切换下载器</li>
<li><input checked="" disabled="" type="checkbox"> 代理功能</li>
<li>[] 后续脚本优化</li>
</ul>
    </div>
    
    <div>
      <ul class="post-copyright">
        <li class="post-copyright-author"><strong>本文作者: </strong>weearc</li>
        <li class="post-copyright-link"><strong>本文链接: </strong><a title="https://blog.weearc.top/posts/55829/" href="https://blog.weearc.top/posts/55829/">https://blog.weearc.top/posts/55829/</a></li>
        <li class="post-copyright-license"><strong>版权声明: </strong>除特殊声明，转载需遵循 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a></li>
      </ul>
    </div>
    
    <div class="tags">
      
        <a href="/tags/firefox">firefox</a>
      
        <a href="/tags/archlinux">archlinux</a>
      
        <a href="/tags/linux">linux</a>
      
        <a href="/tags/firefox-nightly">firefox-nightly</a>
      
    </div>
    
    <div class="post-nav">
      
        <a class="pre" href="/posts/16107/" title="Hello World">Hello World</a>
      
      
        <a class="next" href="/posts/33109/" title="php入门到入土1">php入门到入土1</a>
      
    </div>
    
    
    <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
<div id="vcomments" class=" v" data-class="v"></div>
<script>
    function loadComments() {
        
        new Valine({
            el: '#vcomments',
            appId: 'bhQyg8BFhAianSbFIDztqY5F-gzGzoHsz',
            appKey: 'hyBnHdPlTNOtclNbq8oB5bwg',
            placeholder: 'Just so so',
            notify: 'true',
            verify: 'true',
            path: '\/posts\/55829\/',
            avatar: '',
            meta: '',
            pageSize: '',
            lang: '',
            visitor: '',
            highlight: '',
            avatarForce: '',
            recordIP: ''
        });
    }
    if (window.location.pathname !== '/about/' && window.location.pathname !== '/frlink/') {
        loadComments()
    }
</script>
    

  </div>

        </div>
      </div>
      
      <div class="pure-u-1-4 hidden_mid_and_down">
        <div id="sidebar">
    
<div class="widget">
    <div class="search-form">
        <input id="local-search-input" placeholder="搜索" type="text" name="q" results="0">
        <div id="local-search-result"></div>
    </div>
</div>

    <div class="widget">
    <div class="widget__title">
        <i class="fa fa-folder-o">分类</i>
    </div>
    <ul class="category-list">
        
            <li class="category-list__item">
                <a class="category-list__link" href="https://blog.weearc.top/categories/android/">
                    Android
                </a>
            </li>
        
            <li class="category-list__item">
                <a class="category-list__link" href="https://blog.weearc.top/categories/archlinux/">
                    archlinux
                </a>
            </li>
        
            <li class="category-list__item">
                <a class="category-list__link" href="https://blog.weearc.top/categories/blog/">
                    blog
                </a>
            </li>
        
            <li class="category-list__item">
                <a class="category-list__link" href="https://blog.weearc.top/categories/hello-hexo/">
                    hello hexo
                </a>
            </li>
        
            <li class="category-list__item">
                <a class="category-list__link" href="https://blog.weearc.top/categories/hexo/">
                    hexo
                </a>
            </li>
        
            <li class="category-list__item">
                <a class="category-list__link" href="https://blog.weearc.top/categories/hugo/">
                    hugo
                </a>
            </li>
        
            <li class="category-list__item">
                <a class="category-list__link" href="https://blog.weearc.top/categories/kde/">
                    kde
                </a>
            </li>
        
            <li class="category-list__item">
                <a class="category-list__link" href="https://blog.weearc.top/categories/minecraft/">
                    Minecraft
                </a>
            </li>
        
            <li class="category-list__item">
                <a class="category-list__link" href="https://blog.weearc.top/categories/php/">
                    php
                </a>
            </li>
        
            <li class="category-list__item">
                <a class="category-list__link" href="https://blog.weearc.top/categories/tools/">
                    tools
                </a>
            </li>
        
            <li class="category-list__item">
                <a class="category-list__link" href="https://blog.weearc.top/categories/%E4%B8%80%E8%A8%80/">
                    一言
                </a>
            </li>
        
            <li class="category-list__item">
                <a class="category-list__link" href="https://blog.weearc.top/categories/%E5%89%8D%E7%AB%AF/">
                    前端
                </a>
            </li>
        
            <li class="category-list__item">
                <a class="category-list__link" href="https://blog.weearc.top/categories/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E5%85%B3/">
                    博客相关
                </a>
            </li>
        
            <li class="category-list__item">
                <a class="category-list__link" href="https://blog.weearc.top/categories/%E5%8D%9A%E5%AE%A2%E9%85%8D%E5%A5%97/">
                    博客配套
                </a>
            </li>
        
            <li class="category-list__item">
                <a class="category-list__link" href="https://blog.weearc.top/categories/%E5%AE%9E%E7%94%A8%E5%B7%A5%E5%85%B7/">
                    实用工具
                </a>
            </li>
        
            <li class="category-list__item">
                <a class="category-list__link" href="https://blog.weearc.top/categories/%E5%BE%85%E4%BF%AE%E6%94%B9/">
                    待修改
                </a>
            </li>
        
            <li class="category-list__item">
                <a class="category-list__link" href="https://blog.weearc.top/categories/%E5%BE%85%E5%A1%AB%E5%9D%91/">
                    待填坑
                </a>
            </li>
        
            <li class="category-list__item">
                <a class="category-list__link" href="https://blog.weearc.top/categories/%E6%9D%82%E8%AE%B0/">
                    杂记
                </a>
            </li>
        
            <li class="category-list__item">
                <a class="category-list__link" href="https://blog.weearc.top/categories/%E6%9D%82%E8%B0%88/">
                    杂谈
                </a>
            </li>
        
            <li class="category-list__item">
                <a class="category-list__link" href="https://blog.weearc.top/categories/%E6%B5%8B%E8%AF%95/">
                    测试
                </a>
            </li>
        
            <li class="category-list__item">
                <a class="category-list__link" href="https://blog.weearc.top/categories/%E7%8E%A9%E8%B5%8F/">
                    玩赏
                </a>
            </li>
        
            <li class="category-list__item">
                <a class="category-list__link" href="https://blog.weearc.top/categories/%E8%BD%AC%E8%BD%BD%E7%B2%BE%E5%93%81/">
                    转载精品
                </a>
            </li>
        
            <li class="category-list__item">
                <a class="category-list__link" href="https://blog.weearc.top/categories/%E8%BE%93%E5%85%A5%E6%B3%95/">
                    输入法
                </a>
            </li>
        
            <li class="category-list__item">
                <a class="category-list__link" href="https://blog.weearc.top/categories/%E9%9A%8F%E7%AC%94/">
                    随笔
                </a>
            </li>
        
    </ul>
</div>

    <div class="widget">
    <div class="widget__title">
        <i class="fa fa-tag">
            标签
        </i>
    </div>
    <div class="tagcloud">
        
            <a href="https://blog.weearc.top/tags/android/">android</a>
        
            <a href="https://blog.weearc.top/tags/archlinux/">archlinux</a>
        
            <a href="https://blog.weearc.top/tags/blog/">blog</a>
        
            <a href="https://blog.weearc.top/tags/btrfs/">btrfs</a>
        
            <a href="https://blog.weearc.top/tags/debian/">debian</a>
        
            <a href="https://blog.weearc.top/tags/fcitx/">fcitx</a>
        
            <a href="https://blog.weearc.top/tags/fcitx5/">fcitx5</a>
        
            <a href="https://blog.weearc.top/tags/firefox/">firefox</a>
        
            <a href="https://blog.weearc.top/tags/firefox-nightly/">firefox-nightly</a>
        
            <a href="https://blog.weearc.top/tags/fish-shell/">fish-shell</a>
        
            <a href="https://blog.weearc.top/tags/github-actions/">github-actions</a>
        
            <a href="https://blog.weearc.top/tags/github-webhook/">github-webhook</a>
        
            <a href="https://blog.weearc.top/tags/hello-word/">hello-word</a>
        
            <a href="https://blog.weearc.top/tags/hexo/">hexo</a>
        
            <a href="https://blog.weearc.top/tags/history-file/">history-file</a>
        
            <a href="https://blog.weearc.top/tags/hugo/">hugo</a>
        
            <a href="https://blog.weearc.top/tags/js/">js</a>
        
            <a href="https://blog.weearc.top/tags/linux/">linux</a>
        
            <a href="https://blog.weearc.top/tags/manjaro/">manjaro</a>
        
            <a href="https://blog.weearc.top/tags/markdown/">markdown</a>
        
            <a href="https://blog.weearc.top/tags/minecraft/">minecraft</a>
        
            <a href="https://blog.weearc.top/tags/pandoc/">pandoc</a>
        
            <a href="https://blog.weearc.top/tags/php/">php</a>
        
            <a href="https://blog.weearc.top/tags/redmi/">redmi</a>
        
            <a href="https://blog.weearc.top/tags/ubuntu/">ubuntu</a>
        
            <a href="https://blog.weearc.top/tags/xclip/">xclip</a>
        
            <a href="https://blog.weearc.top/tags/zenity/">zenity</a>
        
            <a href="https://blog.weearc.top/tags/zotero/">zotero</a>
        
            <a href="https://blog.weearc.top/tags/%E4%B8%80%E8%A8%80/">一言</a>
        
            <a href="https://blog.weearc.top/tags/%E5%89%8D%E7%AB%AF/">前端</a>
        
            <a href="https://blog.weearc.top/tags/%E5%8D%87%E7%BA%A7/">升级</a>
        
            <a href="https://blog.weearc.top/tags/%E5%8D%9A%E5%AE%A2/">博客</a>
        
            <a href="https://blog.weearc.top/tags/%E5%8E%BB%E4%BB%96%E5%A6%88%E7%9A%84%E7%BD%91%E6%98%93%E4%BA%91/">去他妈的网易云</a>
        
            <a href="https://blog.weearc.top/tags/%E5%93%8D%E5%BA%94%E5%BC%8F/">响应式</a>
        
            <a href="https://blog.weearc.top/tags/%E5%AE%8C%E5%85%A8%E9%85%8D%E7%BD%AE/">完全配置</a>
        
            <a href="https://blog.weearc.top/tags/%E5%B0%8F%E7%B1%B3/">小米</a>
        
            <a href="https://blog.weearc.top/tags/%E5%BE%85%E4%BF%AE%E6%94%B9/">待修改</a>
        
            <a href="https://blog.weearc.top/tags/%E6%95%99%E7%A8%8B/">教程</a>
        
            <a href="https://blog.weearc.top/tags/%E6%9C%A8%E4%B8%8B%E3%82%86%E3%81%86%E3%81%8B/">木下ゆうか</a>
        
            <a href="https://blog.weearc.top/tags/%E6%9C%A8%E4%B8%8B%E4%BD%91%E9%A6%99/">木下佑香</a>
        
            <a href="https://blog.weearc.top/tags/%E6%9D%82%E8%AE%B0/">杂记</a>
        
            <a href="https://blog.weearc.top/tags/%E6%9D%82%E8%B0%88/">杂谈</a>
        
            <a href="https://blog.weearc.top/tags/%E6%9D%82%E9%A1%B9/">杂项</a>
        
            <a href="https://blog.weearc.top/tags/%E6%A8%A1%E7%89%88/">模版</a>
        
            <a href="https://blog.weearc.top/tags/%E6%AF%95%E4%B8%9A%E5%AD%A3/">毕业季</a>
        
            <a href="https://blog.weearc.top/tags/%E7%94%9F%E5%AD%98%E8%AE%B0%E5%BD%95/">生存记录</a>
        
            <a href="https://blog.weearc.top/tags/%E7%94%B5%E9%87%8F%E7%84%A6%E8%99%91/">电量焦虑</a>
        
            <a href="https://blog.weearc.top/tags/%E7%9F%A5%E4%B9%8E/">知乎</a>
        
            <a href="https://blog.weearc.top/tags/%E7%B3%BB%E7%BB%9F%E5%A4%87%E4%BB%BD/">系统备份</a>
        
            <a href="https://blog.weearc.top/tags/%E7%B3%BB%E7%BB%9F%E8%BF%81%E7%A7%BB/">系统迁移</a>
        
            <a href="https://blog.weearc.top/tags/%E7%BA%A2%E7%B1%B3-k30-pro/">红米-k30-pro</a>
        
            <a href="https://blog.weearc.top/tags/%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2/">自动化部署</a>
        
            <a href="https://blog.weearc.top/tags/%E8%B7%AF%E7%94%B1%E5%99%A8/">路由器</a>
        
            <a href="https://blog.weearc.top/tags/%E8%BD%AC%E8%BD%BD%E6%96%87%E7%AB%A0/">转载文章</a>
        
            <a href="https://blog.weearc.top/tags/%E9%9A%8F%E7%AC%94/">随笔</a>
        
            <a href="https://blog.weearc.top/tags/%E9%A3%9F%E8%B0%B1/">食谱</a>
        
    </div>
</div>

</div>


      </div>
      
      <div class="pure-u-1  pure-u-md-3-4 ">
        
    <footer id="footer">
            <span>Copyright &copy; 2024 | <i class="fa fa-moon-o"></i><a href="https://blog.weearc.top">weearc 的个人博客</a></span></br>
        <span>
            Powered by
            <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> | Theme by
            <a href="https://github.com/weearc" rel="noopener" target="_blank">weearc</a>
        </span></br>
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        <i class="fa fa-eye"></i><span id="busuanzi_container_site_pv"> 总访问量 <span id="busuanzi_value_site_pv"></span> 次 </span> |
        <i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv"> 访客数 <span id="busuanzi_value_site_uv"></span> 人次 </span></br>
        <span>
            <a href="http://beian.miit.gov.cn/" rel="noopener" target="_blank" style="border:none;">
                辽ICP备2020011073号
            </a>
        </span>
    </footer>
    <script>
    var htmlCopyButton = `
    <div id="codeblock-titlebar">
        <span id="lang-title" style="font-size: 5px"></span>
        <button id="clipboard-btn" class="codecopy-btn tooltipped tooltipped-sw" aria-label="Copy to clipboard">
            <span id="clipboard-btn-icon" class="fa fa-copy" aria-hidden="true"></span>
            点击复制
        </button>
    </div>
    `;

    $('.highlight').each(function(index) {
        $(this).prepend(htmlCopyButton)
    });

    $('.codecopy-btn').click(function() {
        var parent = $(this).parent().parent();
        var title = $(this).parent();
        var siblingsNext = parent.children().not(title);
        var tbody = siblingsNext.find('table tbody');
        var td = tbody.find('tr:eq(0)').find('td:eq(1)');
        if ('clipboard' in navigator) {
            navigator.clipboard.writeText(td[0].textContent);

            this.innerHTML = `
            <span id="clipboard-btn-icon" class="fa fa-check" aria-hidden="true"></span>
            已复制！
            `;
            setTimeout(() => {
                this.innerHTML = `
                <span id="clipboard-btn-icon" class="fa fa-copy" aria-hidden="true"></span>
                点击复制
                `;
            }, 900);


            return;
        };
    });
</script>


      </div>
    </div>
  </div>
</body>
</html>

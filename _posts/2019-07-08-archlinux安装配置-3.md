---
title: archlinux安装配置(3)
toc: false
mathjax: false
abbrlink: 12422
date: 2019-07-08 23:22:05
tags: 
  - archlinux
  - linux
  - 完全配置
categories: archlinux
---

距离第一篇博文时隔快两年的更新。由于本次配置文件有问题，KDE直接罢工。修补无果于是决定重装。

<!--more-->

前文：

- [基础系统安装](https://blog.weearc.top/posts/7521.html)
- [基础系统配置](https://blog.weearc.top/posts/60769.html)

# 前言

本文将会涉及到的内容：

- 相当个人级别的系统配置
- 可能非常不符合常理的做法
- 可能涉及到的错误

如果是第一次或者还没安装的话可以先按照正经的步骤进行安装以避免误导。

# chroot下的变更

在正常的安装流程下，我增加安装了几个包：

```
pacman -S fish iw dialog dhcp wpa_supplicant vim sudo screenfetch htop
```

将其分为几类：

- shell: fish(开箱即用的强大shell)
- network: iw dialog wpa_supplicant dhcp(保证进入新系统有网)
- editor: vim(个人非常喜欢的编辑器，更改sudoer会强制使用)
- tools: htop sudo screenfetch(强大的进程管理器、提权工具、基础信息查看)

这样的话进入新系统会节省一部分时间。

# 新系统下的更改

## 用户

由于我是重新安装系统，因此`/home`还在，因此没必要按照常规的在新建用户时候添加`-m`选项：

```
useradd username
```

```
passwd username
```

这样的话就完成了用户建立（并且使用旧的`/home`）。

## 网络

因为之前配置完了大部分的内容，因此进入系统的第二件事是先联网。这里使用的是`netctl`,稍后再更换为`NetworkManager`。

因为是wifi链接，所以执行：

```
wifi-menu
```

然后连接到自己需要的网络。由于个人的路由器是限制设备ip的，因此需要在设备上填入固定IP才能正常联网。虽然上一步执行后失败，但是此时`netctl`已经有了需要的配置文件。形如：

```
# /etc/netctl/wlp2s0-wifi
------------------------------------------------------------------------------------------------
Description='Automatically generated profile by wifi-menu'
Interface=wlp2s0
Connection=wireless
Security=wpa
ESSID= #WiFi名称
IP=static
Address=() #指定的IP
Gateway= #网关，不知道怎么确定的就填写192.168.1.0一般没问题
Key= #密码
```

当然这个是修改过的，然后执行：

```
netctl start wlp2s0-wifi
```

来连接到这个Wifi，并使用：

```
netctl status wlp2s0-wifi
```

查看连接状况。

这样的话应该是有网络了。

## 包管理

按照个人喜好，我比较习惯把包管理的颜色打开，便于区分包。

```
# /etc/pacman.conf
-----------------------------------------------------------------------------------
# Misc options部分
#UseSyslog
Color #取消注释
#TotalDownload
CheckSpace
VerbosePkgLists #取消注释，更新时可看到变动信息

# 32位的东西有时候不可避免，为了不必要的麻烦需要打开
[multilib]
Include = /etc/pacman.d/mirrorlist

# 添加ArchlinuxCN仓库
[archlinuxcn]
SigLevel = TrustedOnly
Server = http://mirrors.cqu.edu.cn/archlinuxcn/$arch
```

之后需要执行：

```
pacman -Syy  #更新本地包管理的数据库
pacman -S archlinuxcn-keyring #添加archlinuxCN的签名，主要是为了安全，大概
```

## 桌面环境安装

一般来讲选KDE还是选gnome这个确实看眼缘。由于gnome上个版本的内存泄露太邪门了，虽然目前已经修好但是我还是用KDE吧。

安装KDE的话一般可能会推荐安装整个Plasma套件，但是好多东西其实用不到，因此也没必要装。我还是决定从最基础的plasma desktop 开始像搭积木一样配置好。

先安装最基础的桌面环境：

```
pacman -S plasma-desktop
```

然后我们装一下驱动，我是intel核显加上A卡独显，不怎么麻烦，并且A卡先不打算用，入门级性能弱的要死也没办法用：

```
pacman -S xf86-video-intel
```

一般这样的话 I 卡就可以正常工作了。然后安装桌面管理器`SDDM`：

```
pacman -S sddm
systemctl enable sddm #添加sddm开机启动
```

因为我们进入桌面环境以后还需要进行配置，因此终端以及文件管理器是必须的：

```
pacman -S konsole dolphin
```

然后重启进入KDE。

## 剩余桌面环境配置

进入桌面环境以后就都属于比较常规的配置了，依照个人喜好进行配置就好。

### 仍然是系统组件部分

一般来讲的话我们的桌面目前已经可以使用了，但是为了一些更加方便的调整我们需要安装一些KDE设置中心的插件。

```bash
pacman -Ss kcm
```

不出意外的话应该得到如下结果：

```bash
extra/kcmutils 5.60.0-1 (kf5) 
    Utilities for interacting with KCModules
extra/sddm-kcm 5.16.3-1 (plasma) 
    KDE Config Module for SDDM
extra/telepathy-kde-accounts-kcm 19.04.3-1 (kde-applications kdenetwork telepathy-kde)
    KCM Module for configuring Telepathy Instant Messaging Accounts
community/kcm-fcitx 0.5.5-2 
    KDE Config Module for Fcitx
community/kcm-wacomtablet 1:3.1.1-1
    KDE GUI for the Wacom Linux Drivers
archlinuxcn/kcm-colorful-git 1.0.1.r0.g2cb0524-1 
    Make your KDE plasma colorful
archlinuxcn/kcm-fcitx5-git r240.62e087f-2
    KDE Config Module for Fcitx5
archlinuxcn/nx-firewall-git 0.1.r70.gdf134bd-1 
    Firewall KCM: Plasma 5 Firewall KCM.
archlinuxcn/systemd-kcm 1.2.1-4 
    Systemd control module for KDE
```

挑选我们喜欢的组件安装即可。

另外，由于对于显示部分以及触控板都有额外组件可以用，参照ArchLinux的wiki来一个个安装就可以了，比如相当常用的两个：

```bash
kscreen   libinput
```

这部分完全是各取所需，另外比如`axel`等命令行工具也是可以根据需求安装的。

### 美化部分

